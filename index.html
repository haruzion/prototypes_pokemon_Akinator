<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pocket Akinator 151</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=DotGothic16&display=swap');
        
        body {
            font-family: 'DotGothic16', sans-serif;
            background-color: #d4d4d8;
        }

        .gb-screen {
            background-color: #8bac0f;
            image-rendering: pixelated;
            position: relative;
        }

        .scanlines::before {
            content: " ";
            display: block;
            position: absolute;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), 
                        linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
            z-index: 10;
            background-size: 100% 3px, 3px 100%;
            pointer-events: none;
        }

        @keyframes flash {
            0%, 100% { background-color: #8bac0f; }
            50% { background-color: #e0f8d0; }
        }
        .animate-flash { animation: flash 0.15s ease-in-out 6; }

        @keyframes legend-border {
            0% { border-color: #0f380f; transform: scale(1); }
            50% { border-color: #306230; transform: scale(1.02); }
            100% { border-color: #0f380f; transform: scale(1); }
        }
        .legend-active { animation: legend-border 0.5s infinite; border-style: double; border-width: 6px; }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        .btn-active:active { transform: translateY(2px); border-bottom-width: 0px; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <!-- GameBoy Housing -->
    <div class="w-full max-w-[360px] bg-zinc-400 rounded-2xl p-6 shadow-2xl border-4 border-zinc-500 relative">
        
        <!-- Battery LED -->
        <div class="absolute left-8 top-12 flex flex-col items-center">
            <div id="battery-led" class="w-2 h-2 rounded-full bg-red-900 border border-zinc-600 transition-colors"></div>
            <span class="text-[6px] font-bold text-zinc-600 mt-1">BATTERY</span>
        </div>

        <!-- Screen Frame -->
        <div class="bg-zinc-700 p-8 rounded-lg mb-6 relative">
            <div class="absolute top-2 left-1/2 -translate-x-1/2 flex gap-10">
                <div class="h-1 w-20 bg-zinc-600 rounded-full"></div>
            </div>
            
            <!-- LCD Screen -->
            <div id="screen" class="gb-screen aspect-square border-4 border-zinc-900 overflow-hidden relative flex flex-col p-3 text-[#0f380f] scanlines">
                
                <!-- Home View -->
                <div id="view-home" class="flex-1 flex flex-col items-center justify-between py-2">
                    <div class="text-center mt-4">
                        <h1 class="text-3xl font-black border-b-4 border-[#0f380f] leading-none">AKINATOR</h1>
                        <p class="text-[10px] tracking-tighter font-bold">POCKET MONSTERS EDITION</p>
                    </div>
                    
                    <div class="w-full px-2 space-y-2 mb-2">
                        <button onclick="gameState.startQuiz()" class="w-full border-2 border-[#0f380f] py-2 text-sm font-bold bg-transparent hover:bg-[#306230] hover:text-[#8bac0f]">‚ñ∂ „ÅØ„Åò„ÇÅ„Çã</button>
                        <button onclick="gameState.showZukan()" class="w-full border-2 border-[#0f380f] py-2 text-sm font-bold bg-transparent hover:bg-[#306230] hover:text-[#8bac0f]">üìñ „Åö„Åã„Çì„Çí„Åø„Çã</button>
                    </div>

                    <div class="text-[8px] text-center leading-tight">¬©1996 GEMINI SYSTEMS<br>MADE IN JAPAN</div>
                </div>

                <!-- Quiz View -->
                <div id="view-quiz" class="hidden flex-1 flex flex-col justify-between">
                    <div class="flex justify-between text-[10px] font-bold">
                        <span id="question-number">Q.1</span>
                        <span id="candidate-count">151 LEFT</span>
                    </div>
                    <div class="flex-1 flex items-center justify-center px-2 py-4">
                        <p id="question-text" class="text-lg font-bold text-center leading-tight"></p>
                    </div>
                    <div class="grid grid-cols-2 gap-2 h-16 shrink-0">
                        <button onclick="gameState.answer(true)" class="border-2 border-[#0f380f] font-bold text-lg hover:bg-[#306230] hover:text-[#8bac0f]">„ÅØ„ÅÑ</button>
                        <button onclick="gameState.answer(false)" class="border-2 border-[#0f380f] font-bold text-lg hover:bg-[#306230] hover:text-[#8bac0f]">„ÅÑ„ÅÑ„Åà</button>
                    </div>
                </div>

                <!-- Result View -->
                <div id="view-result" class="hidden flex-1 flex flex-col items-center justify-between py-4">
                    <div id="legendary-label" class="hidden bg-[#0f380f] text-[#8bac0f] px-2 text-[10px] font-bold animate-bounce">‚ú® LEGENDARY ‚ú®</div>
                    <div id="normal-label" class="text-xs font-bold border-b-2 border-[#0f380f]">„Åõ„ÅÑ„Åã„ÅÑ„ÅØ...</div>
                    
                    <div id="result-sprite" class="w-24 h-24 border-4 border-[#0f380f] flex items-center justify-center text-5xl bg-[#9bbc0f] my-2 transition-transform">
                        ?
                    </div>

                    <div id="result-name" class="text-2xl font-black mb-2"></div>

                    <button onclick="gameState.goHome()" class="w-full bg-[#0f380f] text-[#8bac0f] py-2 font-bold text-sm">ÔºØÔº´</button>
                </div>

                <!-- Zukan View -->
                <div id="view-zukan" class="hidden flex-1 flex flex-col overflow-hidden">
                    <div class="flex justify-between border-b-2 border-[#0f380f] mb-1">
                        <span class="text-[10px] font-bold">POKEDEX: <span id="found-count">0</span>/151</span>
                        <button onclick="gameState.goHome()" class="text-[10px] font-bold underline">BACK</button>
                    </div>
                    <div id="zukan-list" class="flex-1 overflow-y-auto no-scrollbar space-y-1 pr-1">
                        <!-- Zukan items injected here -->
                    </div>
                </div>

            </div>
        </div>

        <!-- Controls -->
        <div class="flex justify-between items-start px-2">
            <!-- D-Pad -->
            <div class="relative w-24 h-24 bg-zinc-350 rounded-full flex items-center justify-center">
                <div class="absolute w-16 h-5 bg-zinc-800 rounded shadow-sm border-x border-zinc-950"></div>
                <div class="absolute w-5 h-16 bg-zinc-800 rounded shadow-sm border-y border-zinc-950"></div>
            </div>
            
            <!-- AB Buttons -->
            <div class="flex gap-4 rotate-[-15deg] mt-4">
                <div class="flex flex-col items-center gap-1">
                    <div class="w-12 h-12 bg-zinc-800 rounded-full border-b-4 border-zinc-950 btn-active cursor-pointer" onclick="gameState.goHome()"></div>
                    <span class="text-[8px] font-bold text-zinc-600">B</span>
                </div>
                <div class="flex flex-col items-center gap-1">
                    <div class="w-12 h-12 bg-zinc-800 rounded-full border-b-4 border-zinc-950 btn-active cursor-pointer" onclick="gameState.playClick()"></div>
                    <span class="text-[8px] font-bold text-zinc-600">A</span>
                </div>
            </div>
        </div>

        <div class="flex justify-center gap-6 mt-8">
            <div class="w-10 h-3 bg-zinc-600 rounded-full rotate-[-25deg] shadow-inner"></div>
            <div class="w-10 h-3 bg-zinc-600 rounded-full rotate-[-25deg] shadow-inner"></div>
        </div>
    </div>

    <script>
        // --- Pokemon Data ---
        const POKEMON_DATA = [
            { id: 1, name: "„Éï„Ç∑„ÇÆ„ÉÄ„Éç", types: ["„Åè„Åï", "„Å©„Åè"], color: "„Åø„Å©„Çä", stage: 0 },
            { id: 4, name: "„Éí„Éà„Ç´„Ç≤", types: ["„Åª„ÅÆ„Åä"], color: "„ÅÇ„Åã", stage: 0 },
            { id: 6, name: "„É™„Ç∂„Éº„Éâ„É≥", types: ["„Åª„ÅÆ„Åä", "„Å≤„Åì„ÅÜ"], color: "„ÅÇ„Åã", stage: 2 },
            { id: 7, name: "„Çº„Éã„Ç¨„É°", types: ["„Åø„Åö"], color: "„ÅÇ„Åä", stage: 0 },
            { id: 25, name: "„Éî„Ç´„ÉÅ„É•„Ç¶", types: ["„Åß„Çì„Åç"], color: "„Åç„ÅÑ„Çç", stage: 1 },
            { id: 52, name: "„Éã„É£„Éº„Çπ", types: ["„Éé„Éº„Éû„É´"], color: "„Åó„Çç", stage: 0 },
            { id: 133, name: "„Ç§„Éº„Éñ„Ç§", types: ["„Éé„Éº„Éû„É´"], color: "„Å°„ÇÉ„ÅÑ„Çç", stage: 0 },
            { id: 143, name: "„Ç´„Éì„Ç¥„É≥", types: ["„Éé„Éº„Éû„É´"], color: "„ÅÇ„Åä", stage: 2 },
            { id: 144, name: "„Éï„É™„Éº„Ç∂„Éº", types: ["„Åì„Åä„Çä", "„Å≤„Åì„ÅÜ"], color: "„ÅÇ„Åä", stage: 2, legend: true },
            { id: 145, name: "„Çµ„É≥„ÉÄ„Éº", types: ["„Åß„Çì„Åç", "„Å≤„Åì„ÅÜ"], color: "„Åç„ÅÑ„Çç", stage: 2, legend: true },
            { id: 146, name: "„Éï„Ç°„Ç§„É§„Éº", types: ["„Åª„ÅÆ„Åä", "„Å≤„Åì„ÅÜ"], color: "„ÅÇ„Åã", stage: 2, legend: true },
            { id: 150, name: "„Éü„É•„Ç¶„ÉÑ„Éº", types: ["„Ç®„Çπ„Éë„Éº"], color: "„ÇÄ„Çâ„Åï„Åç", stage: 2, legend: true },
            { id: 151, name: "„Éü„É•„Ç¶", types: ["„Ç®„Çπ„Éë„Éº"], color: "„Éî„É≥„ÇØ", stage: 2, legend: true }
        ];
        // Á∞°ÊòìÂåñ„ÅÆ„Åü„ÇÅ‰∏ªË¶Å„Å™Êï∞Âåπ„ÅÆ„ÅøÂÆöÁæ©„Åó„Å¶„ÅÑ„Åæ„Åô„Åå„ÄÅÂÆüÈöõ„ÅØ151ÂåπÂàÜ„Éá„Éº„Çø„ÇíÂÖ•„Çå„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô

        // --- Audio Context ---
        let audioCtx = null;
        function initAudio() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            if (audioCtx.state === 'suspended') audioCtx.resume();
            document.getElementById('battery-led').classList.add('bg-red-500');
        }

        function playTone(freq, duration, type = 'square', vol = 0.1) {
            if (!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = type;
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            gain.gain.setValueAtTime(vol, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + duration);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        const gameState = {
            view: 'home',
            candidates: [],
            history: [],
            currentQ: null,
            foundIds: JSON.parse(localStorage.getItem('pokedex_save') || '[]'),

            playClick: () => { initAudio(); playTone(880, 0.1); },
            
            goHome: () => {
                gameState.playClick();
                gameState.showView('home');
                document.getElementById('screen').classList.remove('animate-flash');
                document.getElementById('result-sprite').classList.remove('legend-active');
            },

            showView: (v) => {
                ['home', 'quiz', 'result', 'zukan'].forEach(id => {
                    document.getElementById(`view-${id}`).classList.add('hidden');
                });
                document.getElementById(`view-${v}`).classList.remove('hidden');
                gameState.view = v;
            },

            startQuiz: () => {
                initAudio();
                gameState.candidates = [...POKEMON_DATA];
                gameState.history = [];
                gameState.showView('quiz');
                gameState.nextQuestion();
            },

            nextQuestion: () => {
                if (gameState.candidates.length <= 1) {
                    gameState.showResult();
                    return;
                }

                // Á∞°ÊòìÁöÑ„Å™Ë≥™Âïè„É≠„Ç∏„ÉÉ„ÇØ
                const questions = [
                    { id: 'q_fire', text: "„Åª„ÅÆ„Åä„Çø„Ç§„Éó„ÄÄ„Åã„Å™Ôºü", filter: p => p.types.includes("„Åª„ÅÆ„Åä") },
                    { id: 'q_water', text: "„Åø„Åö„Çø„Ç§„Éó„ÄÄ„Åã„Å™Ôºü", filter: p => p.types.includes("„Åø„Åö") },
                    { id: 'q_legend', text: "„Åß„Çì„Åõ„Å§„ÄÄ„Å®„ÄÄ„ÅÑ„Çè„Çå„Å¶„ÅÑ„ÇãÔºü", filter: p => p.legend === true },
                    { id: 'q_evolve', text: "„Åó„Çì„Åã„ÄÄ„ÅÆ„ÄÄ„Åï„ÅÑ„Åó„ÇÖ„ÅÜ„Åë„ÅÑÔºü", filter: p => p.stage === 2 },
                    { id: 'q_yellow', text: "„Åã„Çâ„Å†„ÅÆ„ÅÑ„Çç„ÅØ„ÄÄ„Åç„ÅÑ„ÇçÔºü", filter: p => p.color === "„Åç„ÅÑ„Çç" }
                ];

                const available = questions.filter(q => !gameState.history.includes(q.id));
                if (available.length === 0) {
                    gameState.showResult();
                    return;
                }
                
                gameState.currentQ = available[0];
                document.getElementById('question-text').innerText = gameState.currentQ.text;
                document.getElementById('question-number').innerText = `Q.${gameState.history.length + 1}`;
                document.getElementById('candidate-count').innerText = `${gameState.candidates.length} LEFT`;
            },

            answer: (isYes) => {
                gameState.playClick();
                gameState.history.push(gameState.currentQ.id);
                gameState.candidates = isYes 
                    ? gameState.candidates.filter(gameState.currentQ.filter)
                    : gameState.candidates.filter(p => !gameState.currentQ.filter(p));
                gameState.nextQuestion();
            },

            showResult: () => {
                const pokemon = gameState.candidates[0] || { name: "ÔºüÔºüÔºü", id: 0 };
                gameState.showView('result');
                document.getElementById('result-name').innerText = pokemon.name;

                if (pokemon.legend) {
                    // ‰ºùË™¨ÊºîÂá∫
                    document.getElementById('screen').classList.add('animate-flash');
                    document.getElementById('result-sprite').classList.add('legend-active');
                    document.getElementById('legendary-label').classList.remove('hidden');
                    document.getElementById('normal-label').classList.add('hidden');
                    
                    // ÁâπÂà•„Éï„Ç°„É≥„Éï„Ç°„Éº„É¨
                    [523, 659, 783, 1046, 1318].forEach((f, i) => {
                        setTimeout(() => playTone(f, 0.8, 'square', 0.1), i * 150);
                    });
                } else {
                    document.getElementById('legendary-label').classList.add('hidden');
                    document.getElementById('normal-label').classList.remove('hidden');
                    playTone(523, 0.2);
                    setTimeout(() => playTone(659, 0.4), 150);
                }

                // ‰øùÂ≠ò
                if (pokemon.id > 0 && !gameState.foundIds.includes(pokemon.id)) {
                    gameState.foundIds.push(pokemon.id);
                    localStorage.setItem('pokedex_save', JSON.stringify(gameState.foundIds));
                }
            },

            showZukan: () => {
                gameState.playClick();
                gameState.showView('zukan');
                const list = document.getElementById('zukan-list');
                list.innerHTML = '';
                document.getElementById('found-count').innerText = gameState.foundIds.length;

                POKEMON_DATA.forEach(p => {
                    const found = gameState.foundIds.includes(p.id);
                    const item = document.createElement('div');
                    item.className = `border-2 p-1 text-[10px] ${p.legend && found ? 'font-bold' : ''} ${found ? 'border-[#0f380f]' : 'border-zinc-500 opacity-50'}`;
                    item.innerHTML = `No.${String(p.id).padStart(3, '0')} ${found ? p.name : 'ÔºüÔºüÔºüÔºüÔºü'} ${p.legend && found ? '‚òÖ' : ''}`;
                    list.appendChild(item);
                });
            }
        };

        // ÂàùÊúüË°®Á§∫
        gameState.goHome();
    </script>
</body>
</html>
